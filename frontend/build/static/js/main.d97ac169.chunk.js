(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{16:function(e,s,t){"use strict";t.r(s);var a=t(2),c=t(3),n=t(6),i=t(5),r=t(1),l=t.n(r),o=t(8),j=t.n(o),d=t(9),h=t(4),u=t(0),b=function(e){return Object(u.jsxs)("div",{id:"sidepanel",children:[Object(u.jsx)("div",{id:"profile",children:Object(u.jsxs)("div",{className:"wrap",children:[Object(u.jsx)("img",{id:"profile-img",src:"http://emilcarlsson.se/assets/mikeross.png",className:"online",alt:""}),Object(u.jsx)("p",{children:"Mike Ross"}),Object(u.jsx)("i",{className:"fa fa-chevron-down expand-button","aria-hidden":"true"}),Object(u.jsx)("div",{id:"status-options",children:Object(u.jsxs)("ul",{children:[Object(u.jsxs)("li",{id:"status-online",className:"active",children:[Object(u.jsx)("span",{className:"status-circle"}),Object(u.jsx)("p",{children:"Online"})]}),Object(u.jsxs)("li",{id:"status-away",children:[Object(u.jsx)("span",{className:"status-circle"}),Object(u.jsx)("p",{children:"Away"})]}),Object(u.jsxs)("li",{id:"status-busy",children:[Object(u.jsx)("span",{className:"status-circle"}),Object(u.jsx)("p",{children:"Busy"})]}),Object(u.jsxs)("li",{id:"status-offline",children:[Object(u.jsx)("span",{className:"status-circle"}),Object(u.jsx)("p",{children:"Offline"})]})]})}),Object(u.jsx)("div",{id:"expanded"})]})}),Object(u.jsxs)("div",{id:"search",children:[Object(u.jsx)("label",{htmlFor:"",children:Object(u.jsx)("i",{className:"fa fa-search","aria-hidden":"true"})}),Object(u.jsx)("input",{type:"text",placeholder:"Search contacts..."})]}),Object(u.jsx)("div",{id:"contacts",children:Object(u.jsxs)("ul",{children:[Object(u.jsx)("li",{className:"contact",children:Object(u.jsxs)("div",{className:"wrap",children:[Object(u.jsx)("span",{className:"contact-status online"}),Object(u.jsx)("img",{src:"http://emilcarlsson.se/assets/louislitt.png",alt:""}),Object(u.jsxs)("div",{className:"meta",children:[Object(u.jsx)("p",{className:"name",children:"Louis Litt"}),Object(u.jsx)("p",{className:"preview",children:"You just got LITT up, Mike."})]})]})}),Object(u.jsx)("li",{className:"contact active",children:Object(u.jsxs)("div",{className:"wrap",children:[Object(u.jsx)("span",{className:"contact-status busy"}),Object(u.jsx)("img",{src:"http://emilcarlsson.se/assets/harveyspecter.png",alt:""}),Object(u.jsxs)("div",{className:"meta",children:[Object(u.jsx)("p",{className:"name",children:"Harvey Specter"}),Object(u.jsx)("p",{className:"preview",children:"Wrong. You take the gun, or you pull out a bigger one. Or, you call their bluff. Or, you do any one of a hundred and forty six other things."})]})]})})]})}),Object(u.jsxs)("div",{id:"bottom-bar",children:[Object(u.jsxs)("button",{id:"addcontact",children:[Object(u.jsx)("i",{className:"fa fa-user-plus fa-fw","aria-hidden":"true"})," ",Object(u.jsx)("span",{children:"Add contact"})]}),Object(u.jsxs)("button",{id:"settings",children:[Object(u.jsx)("i",{className:"fa fa-cog fa-fw","aria-hidden":"true"})," ",Object(u.jsx)("span",{children:"Settings"})]})]})]})},m=t(10),O=function(){function e(){Object(a.a)(this,e),this.callbacks={},this.socketRef=null}return Object(c.a)(e,[{key:"connect",value:function(){var e=this;this.socketRef=new WebSocket("ws://127.0.0.1:8000/ws/chat/test/"),this.socketRef.onopen=function(){console.log("websocket open")},this.socketNewMessage(JSON.stringify({command:"fetch_messages"})),this.socketRef.onmessage=function(s){e.socketNewMessage(s.data)},this.socketRef.onerror=function(e){console.log(e.message)},this.socketRef.onclose=function(s){console.log("websocket is closed"),e.connect()}}},{key:"socketNewMessage",value:function(e){var s=JSON.parse(e),t=s.command;0!==Object.keys(this.callbacks).length&&("messages"===t&&this.callbacks[t](s.messages),"new_message"===t&&this.callbacks[t](s.message))}},{key:"fetchMessages",value:function(e){this.sendMessage({command:"fetch_messages",username:e})}},{key:"newChatMessage",value:function(e){this.sendMessage({command:"new_message",from:e.from,message:e.content})}},{key:"addCallbacks",value:function(e,s){this.callbacks.messages=e,this.callbacks.new_message=s}},{key:"sendMessage",value:function(e){try{this.socketRef.send(JSON.stringify(Object(m.a)({},e)))}catch(s){console.log(s.message)}}},{key:"state",value:function(){return this.socketRef.readyState}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();O.instance=null;var f=O.getInstance(),g=function(e){Object(n.a)(t,e);var s=Object(i.a)(t);function t(e){var c;return Object(a.a)(this,t),(c=s.call(this,e)).sendMessageHandler=function(e){e.preventDefault();var s={from:"admin",content:c.state.message};f.newChatMessage(s),c.setState({message:""})},c.messageChangeHandler=function(e){c.setState({message:e.target.value})},c.renderMessages=function(e){return e.map((function(e){return Object(u.jsxs)("li",{className:"admin"==e.author?"send":"replies",children:[Object(u.jsx)("img",{src:"http://emilcarlsson.se/assets/harveyspecter.png"}),Object(u.jsxs)("p",{children:[e.content,Object(u.jsx)("br",{}),Object(u.jsxs)("small",{children:[Math.round((new Date).getTime()-new Date(e.timestamp).getTime())/6e4," minutes ago"]})]})]},e.id)}))},c.state={message:""},c.waitForSocketConnection((function(){f.addCallbacks(c.setMessages.bind(Object(h.a)(c)),c.addMessage.bind(Object(h.a)(c))),f.fetchMessages(c.props.currentUser)})),c}return Object(c.a)(t,[{key:"waitForSocketConnection",value:function(e){var s=this;setTimeout((function(){if(1===f.state())return console.log("Connection is made"),void e();console.log("wait for connection..."),s.waitForSocketConnection(e)}),100)}},{key:"addMessage",value:function(e){this.setState({messages:[].concat(Object(d.a)(this.state.messages),[e])})}},{key:"setMessages",value:function(e){this.setState({messages:e.reverse()})}},{key:"render",value:function(){var e=this.state.messages;return Object(u.jsxs)("div",{id:"frame",children:[Object(u.jsx)(b,{}),Object(u.jsxs)("div",{className:"content",children:[Object(u.jsxs)("div",{className:"contact-profile",children:[Object(u.jsx)("img",{src:"http://emilcarlsson.se/assets/harveyspecter.png",alt:""}),Object(u.jsx)("p",{children:"username"}),Object(u.jsxs)("div",{className:"social-media",children:[Object(u.jsx)("i",{className:"fa fa-facebook","aria-hidden":"true"}),Object(u.jsx)("i",{className:"fa fa-twitter","aria-hidden":"true"}),Object(u.jsx)("i",{className:"fa fa-instagram","aria-hidden":"true"})]})]}),Object(u.jsx)("div",{className:"messages",children:Object(u.jsx)("ul",{id:"chat-log",children:e&&this.renderMessages(e)})}),Object(u.jsx)("div",{className:"message-input",children:Object(u.jsx)("form",{onSubmit:this.sendMessageHandler,children:Object(u.jsxs)("div",{className:"wrap",children:[Object(u.jsx)("input",{onChange:this.messageChangeHandler,value:this.state.message,type:"text",id:"chat-message-input",placeholder:"Write your message..."}),Object(u.jsx)("i",{className:"fa fa-paperclip attachment","aria-hidden":"true"}),Object(u.jsx)("button",{id:"chat-message-submit",className:"submit",children:Object(u.jsx)("i",{className:"fa fa-paper-plane","aria-hidden":"true"})})]})})})]})]})}}]),t}(l.a.Component),p=function(e){Object(n.a)(t,e);var s=Object(i.a)(t);function t(){return Object(a.a)(this,t),s.apply(this,arguments)}return Object(c.a)(t,[{key:"componentDidMount",value:function(){f.connect()}},{key:"render",value:function(){return Object(u.jsx)(g,{})}}]),t}(l.a.Component);j.a.render(Object(u.jsx)(p,{}),document.getElementById("app"))}},[[16,1,2]]]);
//# sourceMappingURL=main.d97ac169.chunk.js.map